/*	Benjamin DELPY `gentilkiwi`
	http://blog.gentilkiwi.com
	benjamin@gentilkiwi.com
	Licence : https://creativecommons.org/licenses/by/4.0/
*/
#pragma once
#include "kuhl_m.h"
#include "../../modules/asn1/kull_m_kerberos_asn1.h"
#include "../../modules/asn1/kull_m_kerberos_asn1_authinfos.h"
#include "kerberos/kuhl_m_kerberos_pac.h"
#include "kerberos/kuhl_m_kerberos.h"
#include <NtDsAPI.h>

const KUHL_M kuhl_m_exploit;

NTSTATUS kuhl_m_exploit_ms14068(int argc, wchar_t * argv[]);
NTSTATUS kuhl_m_exploit_ms11013(int argc, wchar_t * argv[]);

PWSTR kuhl_m_exploit_ms14068_getname(PCWSTR pre, PCWSTR post);
BOOL kuhl_m_exploit_generic_ms(int argc, wchar_t * argv[], TGS_REP **TgsRep, EncTGSRepPart **encTgsRepPart, PCWSTR szService, PKIWI_AUTH_INFOS *reuseinfos, PKULL_M_SOCK *reusesocket);
BOOL kuhl_m_exploit_give_pac(int argc, wchar_t * argv[], KerberosTime *authtime, PKIWI_AUTH_INFOS infos, PKULL_M_SOCK socket, _octet1 *pac);